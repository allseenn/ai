# Урок 4

Ростислав Ромашин, группа 5128

## kaggle.com на примере titanic

### Описание

**Kaggle** — система организации конкурсов по исследованию данных, а также социальная сеть специалистов по обработке данных и машинному обучению. 

Принадлежит корпорации Google.

Среда организована как публичная веб-платформа, на которой пользователи и организации могут публиковать наборы данных, исследовать и создавать модели, взаимодействовать с другими специалистами по данным и инженерами по машинному обучению, организовывать конкурсы по исследованию данных и участвовать в них. 

В системе размещены наборы открытых данных, предоставляются облачные инструменты для обработки данных и машинного обучения.

Также реализованы обучающие ресурсы, имеется раздел для размещения вакансий работодателями, где тоже возможна организация конкурсов для отбора наилучших кандидатов.

### Начало работы

Знакомство с порталом для дата саентистов https://kaggle.com рекомендуется осуществлять с помощь учебного курса
[Titanic - Machine Learning from Disaster](https://www.kaggle.com/competitions/titanic).

Конкурс **Titanic - Machine Learning from Disaster** на Kaggle предназначен для того, чтобы помочь новичкам в машинном обучении познакомиться с основами этой области. 

В рамках конкурса участники должны создать модель, которая будет предсказывать, выживет ли пассажир на корабле Титаник, используя данные о пассажирах, такие как имя, пол, возраст и т.д.

Чтобы начать работу с Kaggle, нужно зарегистрироваться на сайте и присоединиться к конкурсу Titanic - Machine Learning from Disaster. 

После регистрации можно загрузить набор данных, который содержит информацию о пассажирах Титаника, а также примеры кода, которые помогут начать работу с данными.

Для создания модели, которая будет предсказывать, выживет ли пассажир, нужно будет использовать методы машинного обучения, такие как логистическая регрессия, случайный лес или градиентный бустинг. 

Можно использовать различные языки программирования (Python, R, SQL, Julia), и любые инструменты машинного обучения.

Для работы с данными, используется Kaggle Notebooks - это облачный инструмент, которые позволяют запускать код на Python, R и других языках программирования, а также визуализировать данные и создавать модели машинного обучения.

Основные этапы для участия в соревнованиях

1. Регистрация
2. Настройка личного кабинета
3. Участие в конкурсе.
4. Работа с данными
5. Отправка своих расчетов.

### 1. Регистрация

Для полноценной регистрации рекомендую это делать через аккаунт Google или по адресу электронной почты с последующей привязкой аккаунта kaggle.com к gmail.com.

<img src=pics\01.png>

В процессе регистрации придет письмо с шестизначным кодом, который необходимо в вести в поле для подтверждения.

После подтверждения нужно авторизоваться на портале с помощью указанного логина и пароля, либо, в случае использования gmail, авторизация происходит автоматически.

Если процесс регистрации прошел успешно, то попадаем в личный кабинет.

<img src=pics\02.png>

Главная страница личного кабинета (ЛК) состоит из 4 областей:

1. Панель меню
2. Рабочая область
3. Панель поиска
4. Кнопка настроек

На главной странице ЛК элементы панели меню, почти полностью дублируются элементами главной рабочей области.
Главное меню неизменно при навигации, но его можно уменьшить, оставив только значки без подписей.
Рабочая область меняется в зависимости от навигации.
Панель поиска позволяет быстро найти на сайте нужный документ, конкурс либо пользователя.

### 2. Настройки

При нажатии на кнопку настроек появляется "меню настроек"

<img src=pics\03.png>

Меню настроек содержит следующие пункты:

1. Профиль (Your Profile)
2. Настройки (Settings)
3. Выход (Sign Out)
4. Размер и остаток вычислительной квоты (You accelerator quota)
5. Уведомления (Your notifications)

Рекомендую сразу зайти в пункт "Настройки" (Settings)

<img src=pics\04.png>

И осуществить верификацию телефонного номера (Phone verification). Рекомендую верификацию проводить со смартфона, на котором установлена симка с регистрируемым номером, либо с компьютера подключенного к смартфону через раздачу интернета. Т.к. происходит проверка номера именно с того, с какого вы вышли в интернет. Иначе будет возникать ошибка о невозможности проверить номер.

На момент написания моей статьи, начало 2024 года, никаких ограничений на регистрацию с номеров РФ не было.

<img src=pics\05.jpg>

После успешной верификации номера открываются дополнительные возможности:

<img src=pics\06.jpg>

1. Публикации на форумах kaggle.com
2. Для блокнотов становится доступен интернет
3. Блокноты можно делать публичными
4. Доступны особые соревнования
5. Возможность оставлять комментарии на портале
6. Хранилище для приватных моделей
7. Возможность роста по рангу (Tier)
8. В ноутбуках появляется поддержка GPU

<img src=pics\07.jpg>

### 3. Конкурсы

Для участия в конкретном конкурсе, например titanic, необходимо в панели поиска  набрать его название

<img src=pics\08.png>

Titanic Tutorial будет первым в списке. Рекомендую перейти по этой ссылке, т.к. это учебная инструкция, описывающая конкурс Titanic - Machine Learning from Disaster.
Само же соревнование расположено по адресу
https://www.kaggle.com/competitions/titanic

где URL указывает, что мы в разделе competitions (соревнования) - titanic (Титаник)

Чтобы отобразить список всех соревнований, в главном меню необходимо выбрать пункт Competitions (соревнования).
Отобразится список всех соревнований, который можно отсортировать по дате, популярности и другим параметрам

<img src=pics\09.png>

Для того, чтобы присоединиться к соревнованию, в нашем случае титанику, перейдя по ссылке https://www.kaggle.com/competitions/titanic

Необходимо присоединиться к конкурсу, нажав кнопку "Join Competition" справа сверху

<img src=pics\10.png>

Структура страницы любого соревнования состоит из следующих закладок

1. Обзор (Overview)
2. Данные (Data)
3. Код (Code)
4. Модели (Models)
5. Дискуссии (Discussion)
6. Доска лидеров (Leaderboard)
7. Правила (Rules)
8. Команда (Team)
9. Отправки (Submissions)

<img src=pics\11.png>

### 4. Работа с данными

У всех соревнований во вкладке Данные (Data), находятся как минимум два CSV файла:

- test.csv (Тестовые данные)
- train.csv (Тренировочные данные)
  Конкретно у Титаника есть третий файл:
- gender_submission.csv

Основная задача скачать эти файлы, обработать и составить выходной файла submission.csv, который будет содержат всего два поля:

- Passenerid
- Survived

Побеждает тот, кто отправит sumbission с наиболее точными данными. Т.е. задача написать такой код, который на основе имеющихся данных (test.csv и train.csv), любыми доступными в kaggle notebook средствами, разработает модель, предсказывающую реальные события.

Для написания кода, необходимо перейти во вкладку Код (Code) и нажать кнопку +New Notebook

<img src=pics\12.png>

Откроется блокнот основанный на Jupiter Notebook на языке python. В первой ячейке которого будет основная информация в виде комментариев и кода, позволяющего загрузить тестовые и тренировочные данные в отрытый ноутбук

<img src=pics\13.png>

На данной картинке видно, какие библиотеки используются и какие файлы загружены.

Можно приступать к обработке тестовых и тренировочных данных

<img src=pics\13.png>

Далее подключаем библиотеку `sklearn.ensemble` для создания модели случайного леса (`RandomForestClassifier`). Модель обучается на данных `train_data`, которые содержат информацию о пассажирах Титаника, включая их класс (`Pclass`), пол (`Sex`), количество братьев и сестер/супругов (`SibSp`) и количество родителей/детей (`Parch`).

Далее, данные преобразуются в формат, который может быть использован моделью, с помощью метода `pd.get_dummies()`. Этот метод преобразует категориальные признаки в числовые, чтобы их можно было использовать в модели.

Затем модель обучается на преобразованных данных с использованием гиперпараметров `n_estimators=100`, `max_depth=5` и `random_state=1`. После обучения модель делает прогнозы на данных `test_data` и сохраняет их в файл `submission.csv`.

<img src=pics\14.png>

У ноутбука справа на верху есть кнопка Сохранить Версию (Save Version), конкурс Титаник позволяет сохранить до 50 вариантов ноутбука

При нажатии на кнопку Сохранить версию, появится подменю, в котором можно выбрать вычислительные мощности, как я об этом писал ранее.

### Отправка расчетов

После успешного завершения расчетов, создается файл submission.csv и при нажатии на кнопку Submit Prediction (Отправка предсказаний), расчеты отправляются на проверку.

Во вкладке Отправки (Submissions), можно посмотреть свои отправки и их набранный балл, т.е. процент совпадений с оригинальными данными

<img src=pics\16.png>

В своем профиле можно увидеть, количество участников и какое место занято в конкретном соревновании

<img src=pics\17.png>
